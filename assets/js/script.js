function calendar(){monthDays[1]=year%4==0?29:28;var e=document.createElement("table");row=document.createElement("tr"),head=document.createElement("th"),firstMonthDay=new Date(year,month,1),firstMonthDay=0==firstMonthDay.getDay()?7:firstMonthDay.getDay(),firstDay=1,active=1,currentMonth=monthNames[month],lastDay=monthDays[month],date_area=document.querySelector(".header-calendar h2"),date_area.innerHTML=monthNames[month]+" "+year,today=new Date,today=[today.getMonth(),today.getDate(),1900+today.getYear()];for(var t=0;t<6;t++){row=e.insertRow(t);for(var a=0;a<7;a++){var n=new Date(year,month,firstDay);localStorage.getItem(n);if(cell=row.insertCell(a),month==today[0]&&firstDay==today[1]&&year==today[2]&&cell.setAttribute("class","active today"),0==t&&a+1<firstMonthDay){var o=month-1==-1?11:month-1;cell.setAttribute("class","non-active"),cell.innerHTML=monthDays[o]-(firstMonthDay-a-2)}else{firstDay>lastDay&&(firstDay=1,active=0);var n=new Date(year,month,firstDay);null!=localStorage.getItem(n)&&null==cell.getAttribute("class")&&cell.setAttribute("class","contains-note"),cell.innerHTML=firstDay,0==active&&cell.setAttribute("class","non-active"),firstDay++}}e.appendChild(row)}calendarArea.appendChild(e),cell_add=document.querySelectorAll("td"),form_display(),event_display(),active_day()}function form_display(){for(var e=0;e<cell_add.length;e++)cell_add[e].addEventListener("dblclick",function(){click_day=this.innerHTML,click_date=new Date(year,month,click_day),add_in_list.style.display="block"})}function event_display(){for(var e=0;e<cell_add.length;e++)cell_add[e].addEventListener("click",function(){click_day=this.innerHTML,click_date=new Date(year,month,click_day),create_content(JSON.parse(localStorage.getItem(click_date)))})}function create_content(e){var t=document.createElement("h2"),a=document.createElement("div"),n=document.querySelector(".note");if(n.innerText="",t.innerText="What to do today ?",null!=e){short(e);for(var o=0;o<e.length;o++)noteCreate=document.createElement("div"),dateCreate=document.createElement("p"),contentCreate=document.createElement("p"),dateCreate.innerText=e[o][0],contentCreate.innerText=e[o][1],n.appendChild(t),noteCreate.appendChild(dateCreate),noteCreate.appendChild(contentCreate),a.appendChild(noteCreate)}else{var r=document.createElement("p");r.innerText="Nothing plan for this day",a.appendChild(r)}n.append(a)}function short(e){for(var t=0;t<e.length;t++){for(var a=e[t],n=t-1;n>=0&&e[n][0]>a[0];)e[n+1]=e[n],n--;e[n+1]=a}}function active_day(){for(var e=0;e<cell_add.length;e++)cell_add[e].addEventListener("click",function(){var e=document.querySelector(".active");void 0!=e&&e.classList.remove("active"),this.classList.add("active")})}function position(e){lat=e.coords.latitude,long=e.coords.longitude,api()}function api(){var e=lat?"./weather-api.php?lat="+lat+"&long="+long:"./weather-api.php";console.log(e),self.fetch?fetch(e).then(function(e){return e.json()}).then(function(e){weather.result=e,weather_display()}):console.log("non supporté"),console.log(weather.result)}function weather_display(){var e=document.querySelector(".city"),t=document.querySelector(".temperature"),a=document.querySelector(".img-weather"),n=weather.result.description;n=n.replace(" ","-"),e.innerText=weather.result.city,t.innerText=parseInt(weather.result.temperature)+"°C",a.classList.add(n),console.log(n)}function localisation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(position,api)}var monthNames=["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Decembre"],monthDays=[31,28,31,30,31,30,31,31,30,31,30,31],today=new Date,day=today.getDay(),date=today.getDate(),year=1900+today.getYear(),month=today.getMonth(),calendarArea=document.querySelector(".day"),cell_add;calendar(),create_content(JSON.parse(localStorage.getItem(today)));var boutonNext=document.querySelector(".next"),boutonPrevious=document.querySelector(".previous");boutonNext.addEventListener("click",function(){month>10?(month=0,year+=1):month+=1,calendarArea.querySelector("table").remove(),calendar()}),boutonPrevious.addEventListener("click",function(){month<=0?(month=11,year-=1):month-=1,calendarArea.querySelector("table").remove(),calendar()});var click_day,click_date,add_in_list=document.querySelector(".add-in-list"),quit=document.querySelector(".quit"),submit=document.querySelector(".submit-add");quit.addEventListener("click",function(){add_in_list.style.display="none"}),submit.addEventListener("click",function(e){var t=[[document.querySelector("#hour").value,document.querySelector("#what").value]];click_date=new Date(year,month,click_day);var a=JSON.parse(localStorage.getItem(click_date));t=null!=a?a.concat(t):t,t=JSON.stringify(t),localStorage.setItem(click_date,t),e.preventDefault(),calendarArea.querySelector("table").remove(),add_in_list.style.display="none",calendar()});var titleToDo=document.createElement("h2"),noteArea=document.createElement("div"),noteDiv=document.querySelector(".note"),close_tuto=document.querySelector(".close-tuto"),tuto=document.querySelector(".tuto-div"),tuto_open=document.querySelector(".tuto");0!=localStorage.length&&(tuto.style.display="none"),close_tuto.addEventListener("click",function(){tuto.style.display="none"}),tuto_open.addEventListener("click",function(){tuto.style.display="block"});var weather={},lat=!1,long=!1;localisation();